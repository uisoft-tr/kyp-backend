import{r as c,aB as e,b0 as C,aF as w,aD as F,ba as D,bh as N,b2 as I,bb as B,b9 as E,bc as S,b5 as T,aI as K}from"./index-iICuzTeq.js";import{aj as p,ak as A,al as g,B as f,ap as R,H as v}from"./AuthGate-BbxU_GZy.js";import{S as o,b as O,C as L,c as $,F as P,R as M,Y as H}from"./App-Dj5y_YEV.js";import{R as q,e as G}from"./exportExcel-BWEvanXS.js";const J=({onFilterChange:r})=>{const[l]=p.useForm(),[u,s]=c.useState([]),[x]=c.useState(Array.from({length:25},(a,t)=>2025+t)),d=a=>{r(a)};return c.useEffect(()=>{(async()=>{try{const t=await C.get({entity:"/isin_adi"});s(t)}catch(t){console.error("İşin adları alınamadı:",t)}})()},[]),e.jsxs(p,{form:l,layout:"vertical",onFinish:d,className:"w-full mx-auto px-5",children:[e.jsxs(A,{gutter:[16,16],children:[e.jsx(g,{xs:24,sm:12,md:12,lg:6,children:e.jsx(p.Item,{label:"İşin Adı",name:"isin_adi",children:e.jsx(o,{allowClear:!0,showSearch:!0,filterOption:(a,t)=>t.children.toLowerCase().includes(a.toLowerCase()),children:u.map(a=>e.jsx(o.Option,{value:a.id,children:a.ad},a.id))})})}),e.jsx(g,{xs:24,sm:12,md:12,lg:6,children:e.jsx(p.Item,{label:"Yapılış Şekli",name:"yapilis_sekli",children:e.jsxs(o,{allowClear:!0,children:[e.jsx(o.Option,{value:"kamulastırma",children:"Kamulaştırma"}),e.jsx(o.Option,{value:"kamulastırma_disi",children:"Kamulaştırma Dışı"})]})})}),e.jsx(g,{xs:24,sm:12,md:12,lg:6,children:e.jsx(p.Item,{label:"Başlama Yılı",name:"baslama_tarihi",children:e.jsx(o,{allowClear:!0,children:x.map(a=>e.jsx(o.Option,{value:a,children:a},a))})})}),e.jsx(g,{xs:24,sm:12,md:12,lg:6,children:e.jsx(p.Item,{label:"Bitiş Yılı",name:"bitis_tarihi",children:e.jsx(o,{allowClear:!0,children:x.map(a=>e.jsx(o.Option,{value:a,children:a},a))})})})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(O,{children:[e.jsx(f,{type:"primary",htmlType:"submit",children:"Filtrele"}),e.jsx(f,{onClick:()=>{l.resetFields(),r({})},children:"Temizle"})]})})]})},Q=({onCollapseChange:r})=>{const l=w(),{page:u,pageSize:s,filters:x}=F(a=>a.data),d=async a=>{try{l(D(!0)),l(N(a)),l(I(1));const t=await C.filter({entity:"/yatirimlar",values:{...a,page:1,page_size:s}});l(B(t))}catch(t){console.error("Filtreleme işlemi sırasında bir hata oluştu:",t)}finally{l(D(!1))}};return e.jsx(L,{onChange:a=>r(a.length>0),items:[{key:"1",label:e.jsx("span",{className:"text-white font-bold",children:"Filtrele"}),children:e.jsx(J,{onFilterChange:d})}],className:"bg-[#0F6769]"})},U=({setDrawerOpen:r,setIsEdit:l,collapsed:u})=>{const{datas:{results:s,count:x},page:d,pageSize:a,filters:t}=F(i=>i.data),h=w(),m=R(),b=()=>{G({endpoint:"/yatirimlar/export-excel",filters:t,filename:"yatırımlar.xlsx"})},y=(i,n)=>{h(I(i)),h(E(n))},j=i=>{const n=s.find(k=>k.id===i);h(S(n)),l(!0),r(!0)},{deletingId:_,handleDelete:z}=$("/yatirimlar",null,i=>{const n=s.find(k=>k.id===i);return n?`"${n.isin_adi_ad}" adlı yatırımı silmek istediğinize emin misiniz?`:"Bu öğeyi silmek istediğinize emin misiniz?"},()=>{h(T({page:1,pageSize:a,filters:t}))}),Y=[{title:"İşin Adı",dataIndex:"isin_adi_ad",key:"isin_adi_ad",width:200},{title:"Toplam Keşif ve İhale Bedeli",dataIndex:"toplam_kesif_ihale_bedeli",key:"toplam_kesif_ihale_bedeli",width:250,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Yıl Sonuna Kadar Harcama",dataIndex:"yil_sonuna_kadar_harcama",key:"yil_sonuna_kadar_harcama",width:250,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Yıl Keşif Bedeli",dataIndex:"yil_kesif_bedeli",key:"yil_kesif_bedeli",width:150,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Yıl Nakdi",dataIndex:"yil_nakti",key:"yil_nakti",width:120,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Revize Ödenek",dataIndex:"revize_odenk",key:"revize_odenk",width:150,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"BBB ve Sonrası Keşif Bedeli",dataIndex:"bbb_ve_sonrasi_kesif_bedeli",key:"bbb_ve_sonrasi_kesif_bedeli",width:250,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Yapılış Şekli",dataIndex:"yapilis_sekli",key:"yapilis_sekli",width:150,render:i=>i==="kamulastırma"?"Kamulaştırma":"Kamulaştırma Dışı"},{title:"Başlama Yılı",dataIndex:"baslama_tarihi",key:"baslama_tarihi",width:130},{title:"Bitiş Yılı",dataIndex:"bitis_tarihi",key:"bitis_tarihi",width:130},{title:"Talep",dataIndex:"talep",key:"talep",width:130,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"Tenkis",dataIndex:"tenkis",key:"tenkis",width:130,render:i=>new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(i)},{title:"",key:"actions",fixed:"right",render:(i,n)=>e.jsxs("div",{className:`flex justify-center !p-0 ${m?"":"gap-2"}`,children:[e.jsx(v,{title:"Düzenle",children:e.jsx(f,{className:`${m?"text-[14px]":"text-[18px]"}`,type:"text",icon:e.jsx(q,{}),onClick:()=>j(n.id)})}),e.jsx(v,{title:"Sil",children:e.jsx(f,{danger:!0,className:`${m?"text-[14px]":"text-[18px]"}`,type:"text",icon:e.jsx(M,{}),loading:_===n.id,onClick:()=>z(n.id)})})]})}];return e.jsx(e.Fragment,{children:e.jsx(P,{dataSource:s,columns:Y,rowKey:"id",pagination:{responsive:!0,current:d,pageSize:a,total:x,showLessItems:!1,onChange:y,showTotal:i=>m?"":e.jsxs("div",{children:["Toplam ",e.jsx("span",{className:"font-bold",children:i})," yatırımdan"," ",e.jsx("span",{className:"font-bold",children:s.length})," ","gösteriliyor."]})},scroll:u?{y:400,x:"max-content"}:{x:"max-content",y:"max-content"},footer:()=>(s==null?void 0:s.length)>0?e.jsx(f,{type:"primary",onClick:b,style:{position:"absolute",bottom:0,left:0,zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",borderRadius:6},className:` ${m?"text-[10px]":"text-[14px]"}`,children:"Excel'e Aktar"}):null})})},ee=()=>{const[r,l]=c.useState(!1),[u,s]=c.useState(!1),[x,d]=c.useState(!1),a=w(),t=R(),{page:h,pageSize:m,filters:b,loading:y}=F(_=>_.data),j=()=>{s(!1),a(S(null)),d(!1)};return c.useEffect(()=>{a(T({page:h,pageSize:m,filters:b}))},[a,h,m,b]),c.useEffect(()=>()=>{a(N({})),a(I(1))},[a]),e.jsxs("div",{className:`flex flex-col  px-1 gap-2 w-full h-full ${t?"mt-5":""}`,children:[e.jsx(Q,{onCollapseChange:l}),e.jsx("div",{className:"flex-1 overflow-hidden",children:y?e.jsx(K,{}):e.jsx("div",{className:r?"overflow-auto":"w-full",children:e.jsx(U,{setIsEdit:d,setDrawerOpen:s,collapsed:r})})}),e.jsx(H,{open:u,onClose:j,isEdit:x})]})};export{ee as default};
