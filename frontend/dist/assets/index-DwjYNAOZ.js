import{r as e,aE as y,aB as a,aI as k,b0 as m}from"./index-CuRaiCHi.js";import{M as w,a as Y}from"./App-DuAM1Q1r.js";import{aj as j,ap as D,ai as g,an as N,ao as S}from"./AuthGate-yUozBba6.js";const v=()=>{const[d,u]=e.useState(!0),[i,f]=e.useState(null),[r]=j.useForm(),[p,h]=e.useState([]),o=D(),[F,M]=e.useState(null),b=y();e.useEffect(()=>{(async()=>{try{const s=await m.get({entity:"/makine/?no_pagination=true"});h(s)}catch(s){console.error("DSİ No verisi alınamadı:",s)}finally{u(!1)}})()},[]);const x=async t=>{var s,c,l;if(!i){g({description:"Lütfen haritadan bir konum seçiniz."});return}try{const n={...t,konum:{type:"Point",coordinates:[i[0],i[1]]},tarih:(s=t.tarih)==null?void 0:s.format("YYYY-MM-DD"),ise_baslama:(c=t.ise_baslama)==null?void 0:c.format("YYYY-MM-DD"),ise_bitis:(l=t.ise_bitis)==null?void 0:l.format("YYYY-MM-DD")};await m.post({entity:"/makine_takip/",jsonData:n}),N({description:"Makine Takibi Kaydedildi!"}),setTimeout(()=>{b("/")},2e3),r.resetFields()}catch(n){console.error("Kayıt başarısız:",n),S({description:"Kayıt sırasında bir hata oluştu"})}};return a.jsx("div",{className:`flex  gap-4 h-full w-full mb-2 ${o?" flex-col-reverse py-4 px-2":"flex-row justify-between p-4"}`,children:d?a.jsx(k,{}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:o?"w-full":"w-[30%]",children:a.jsx(w,{coordinates:i,onFormSubmit:x,form:r,dsiList:p})}),a.jsx("div",{className:o?"w-full h-96":"w-[70%] h-full",children:a.jsx(Y,{onMapClick:t=>f(t),moduleName:"makine_takip",onMapReady:M})})]})})};export{v as default};
